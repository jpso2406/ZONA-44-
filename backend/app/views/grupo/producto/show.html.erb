<!-- app/views/productos/show.html.erb -->
<section class="producto-fullpage">

  <!-- NAVBAR -->
  <header class="pf-nav">
    <div class="pf-container">
      <div class="brand"><i class="fas fa-utensils"></i> FastFoodX</div>
      <nav class="pf-nav-links" aria-label="navegacion principal">
        <%= link_to "Inicio", root_path, class: "nav-link" %>
        <%= link_to "Men√∫", grupo_index_path, class: "nav-link" %>
        <%= link_to "Carrito", mostrar_carrito_path, class: "nav-cta" %>
      </nav>
    </div>
  </header>

  <!-- MAIN LAYOUT -->
  <main class="pf-container pf-grid">
    <!-- LEFT COLUMN: GALLERY + INFO -->
    <article class="pf-main">
      <section class="pf-gallery">
        <div class="pf-main-image" id="mainImage">
          <% if @producto.foto.attached? %>
            <%= image_tag @producto.foto.variant(resize_to_limit: [1200, 800]), alt: @producto.name %>
          <% else %>
            <%= image_tag "sin_imagen.png", alt: "Sin imagen" %>
          <% end %>
        </div>

        <div class="pf-thumbs" id="thumbs">
          <%# Si tienes m√°s im√°genes, mostrar; si no, mostrar la misma %>
          <% if @producto.foto.attached? %>
            <button class="thumb active" data-src="<%= url_for(@producto.foto) %>">
              <%= image_tag @producto.foto.variant(resize_to_limit: [200, 200]), alt: @producto.name %>
            </button>
          <% else %>
            <button class="thumb active" data-src="/assets/sin_imagen.png">
              <img src="/assets/sin_imagen.png" alt="Sin imagen">
            </button>
          <% end %>
          <%# placeholder for additional thumbs if you attach multiple images later %>
        </div>
      </section>

      <section class="pf-info">
        <div class="kicker"> <span class="badge-category"><i class="fas fa-tag"></i> <%= @grupo.nombre %></span></div>

        <h1 class="pf-title"><%= @producto.name %></h1>

        <div class="pf-meta">
          <div class="rating">
            <span class="score">4.6</span>
            <span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ</span>
            <span class="reviews">‚Ä¢ 128 rese√±as</span>
          </div>
          <div class="time">‚è± 15-20 min</div>
        </div>

        <p class="pf-desc"><%= simple_format(@producto.descripcion || "Delicioso y reci√©n preparado.") %></p>

        <div class="pf-tags">
          <span class="tag">üî• Popular</span>
          <span class="tag">‚ôªÔ∏è Sin TACC</span>
          <span class="tag">üåø Opciones veganas</span>
        </div>

        <div class="pf-sections">
          <h3>Ingredientes</h3>
          <ul class="ingredientes">
            <%# ejemplo: si tienes ingredientes almacenados, map√©alos; si no, muestra texto %>
            <% if @producto.respond_to?(:ingredientes) && @producto.ingredientes.present? %>
              <% @producto.ingredientes.each do |ing| %>
                <li><i class="fas fa-leaf"></i> <%= ing %></li>
              <% end %>
            <% else %>
              <li><i class="fas fa-check-circle"></i> Carne / Queso / Lechuga / Pan artesanal</li>
              <li><i class="fas fa-check-circle"></i> Salsa secreta de la casa</li>
              <li><i class="fas fa-check-circle"></i> Papas crocantes (opcional)</li>
            <% end %>
          </ul>
        </div>

        <details class="pf-nutrition">
          <summary>Informaci√≥n nutricional</summary>
          <div class="nutri-grid">
            <div><strong>Calor√≠as</strong><span>560 kcal</span></div>
            <div><strong>Prote√≠nas</strong><span>28 g</span></div>
            <div><strong>Carbs</strong><span>48 g</span></div>
            <div><strong>Grasas</strong><span>30 g</span></div>
          </div>
        </details>
      </section>
    </article>

    <!-- RIGHT COLUMN: ORDER SUMMARY (sticky) -->
    <aside class="pf-aside" id="orderPanel" aria-labelledby="orderPanelTitle">
      <div class="aside-card">
        <h2 id="orderPanelTitle">Tu pedido</h2>

        <div class="price-row">
          <div class="price-big">$<span id="precioUnitario"><%= number_with_precision(@producto.precio, precision: 0, delimiter: ".") %></span></div>
          <div class="small-note">Precio unitario</div>
        </div>

        <div class="qty-row">
          <label for="qty">Cantidad</label>
          <div class="qty-controls" role="group" aria-label="Cantidad">
            <button type="button" id="qtyMinus" class="qty-btn">‚àí</button>
            <input id="qty" type="number" min="1" value="1" aria-live="polite">
            <button type="button" id="qtyPlus" class="qty-btn">+</button>
          </div>
        </div>

        <div class="add-ons">
          <h4>Agregar</h4>
          <label class="addon">
            <input type="checkbox" class="addon-checkbox" data-price="2000"> Queso extra +$2.000
          </label>
          <label class="addon">
            <input type="checkbox" class="addon-checkbox" data-price="3500"> Papas medianas +$3.500
          </label>
        </div>

        <div class="total-row">
          <div>Total</div>
          <div class="total-amount" id="totalAmount">$<span id="totalValue">0</span></div>
        </div>

        <div class="aside-actions">
          <%= button_to "Agregar al carrito üõí", agregar_al_carrito_path(@producto), method: :post, class: "btn-add-to-cart", data: { disable_with: "A√±adiendo..." } %>
          <%= link_to "Pedir ahora", root_path, class: "btn-order-now" %>

        </div>+

        <div class="foot-note">Entrega en tu zona ‚Ä¢ Pago con tarjeta o efectivo</div>
      </div>
    </aside>
  </main>
</section>
